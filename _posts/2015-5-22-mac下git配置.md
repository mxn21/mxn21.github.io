---
layout: post
author: mxn
title: mac下git配置
category: 技术博文
tag: [android]
---


本文介绍如何在 mac 机器上创建 Git 服务器，总体思路是：使用 gitosis 来简化创建过程，在用作服务器的机器上创建 git 服务器，其他客户端通过 ssh 机制访问 git 服务器。

####1、创建用户
可以创建单独用户用于git，这里为了简单也可以不创建。在系统偏好设置的共享中，勾选远程登陆，并且允许所有用户访问。这里也可以创建用户之后，选择允许特定的用户访问。

####2、下载安装 gitosis

Mac默认已经为我们安装了 Git 和 Python，可以使用如下命令查看其版本信息：

{% highlight c %}

yourname:~ git$ git --version
git version 2.3.2 (Apple Git-55)
yourname:~ git$ python --version
Python 2.7.6

{% endhighlight  %}

通过命令 "git clone https://github.com/res0nat0r/gitosis.git"来下载 gitosis
{% highlight c %}

yourname:~ git$ git clone https://github.com/res0nat0r/gitosis.git
Cloning into 'gitosis'...
remote: Counting objects: 727, done.
remote: Total 727 (delta 0), reused 0 (delta 0), pack-reused 727
Receiving objects: 100% (727/727), 179.61 KiB | 61.00 KiB/s, done.
Resolving deltas: 100% (407/407), done.
Checking connectivity... done.

{% endhighlight  %}

进入 gitosis 目录，使用命令 "sudo python setup.py install" 来执行 python 脚本来安装 gitosis。

{% highlight c %}
yourname:~ git$ cd gitosis/
yourname:gitosis git$ sudo python setup.py install
Password:
running install
Checking .pth file support in /Library/Python/2.7/site-packages/
/usr/bin/python -E -c pass
TEST PASSED: /Library/Python/2.7/site-packages/ appears to support .pth files
running bdist_egg
running egg_info
creating gitosis.egg-info
writing requirements to gitosis.egg-info/requires.txt
writing gitosis.egg-info/PKG-INFO
writing top-level names to gitosis.egg-info/top_level.txt
......
Using /System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python
Finished processing dependencies for gitosis==0.2
{% endhighlight  %}


####3、制作 ssh rsa 公钥

回到 client 机器上，制作 ssh 公钥。在这里我的使用同一台机器上的同一个账户作为 client。如果作为 client 的机器与作为 server 的机器不是同一台，也是类型的流程：制作公钥，放置到服务的 /tmp 目录下。在同一台机器上，我们可以通过开启另一个 terminal，使用 su 切换到 local 账户,也可以同时操作两个账户。

{% highlight c %}

yourname:~ git$ su local_account
Password:
bash-3.2$ cd ~
bash-3.2$ ssh-keygen -t rsa
Generating public/private rsa key pair.
Enter file in which to save the key (/Users/local_account/.ssh/id_rsa): 
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /Users/local_account/.ssh/id_rsa.
Your public key has been saved in /Users/local_account/.ssh/id_rsa.pub.

bash-3.2$ cd .ssh
bash-3.2$ ls
id_rsa        id_rsa.pub
bash-3.2$ cp id_rsa.pub /tmp/yourame.pub

{% endhighlight  %}

在上面的命令里，首先通过 su 切换到 local 账户（只有在同一台机器上才有效），然后进入到 local 账户的 home 目录，使用 ssh-keygen -t rsa 生成 id_rsa.pub，最后将该文件拷贝放置到  /tmp/yourname.pub，这样 git 账户就可以访问 yourname.pub了，在这里改名是为了便于在 git 中辨识多个 client。









