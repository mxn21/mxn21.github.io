---
layout: post
author: mxn
titile: 下载编译androd源码笔记
category: 技术博文
tag: android
---

这几天下载编译了android源码，下面是一些笔记。

### 准备工作

1.安装JDK和Xcode, 一般android开发人员的mac电脑上这两样应该是必备的吧。我的JDK是1.7版本，没试过1.8是否可行。
安装Xcode是因为需要里面Command Line Tools的。从Yosemite开始，Command Line Tools可以单独安装，无需像之前一样
必须先安装Xcode才能安装Command Line Tools。但是直接装Xcode是最方便的，避免后续打的其他问题。

2.准备50G的硬盘空间，由于我的mac空间不足50G,我也不想浪费大量的空间，所以我直接下载到移动硬盘上，用mac的磁盘工具对
移动硬盘分区，选择格式的时候选择mac OS扩展（区分大小写）。

![](https://raw.githubusercontent.com/mxn21/mxn21.github.io/master/public/img/img188.png)

<!-- more --> 

### 下载源码

#### 1.安装repo

Repo是一个辅助于Git管理Android版本及分支的工具.在安装repo前,需要新建一个文件夹~/bin,并把这个文件夹放到PATH环境变量里,
然后我们就可以把repo下载到这个文件夹里.
依次输入下面的命令，这里需要使用VPN.

    {% highlight c %} 
    $ mkdir ~/bin
    $ PATH=~/bin:$PATH
    $ curl https://storage.googleapis.com/git-repo-downloads/repo > ~/bin/repo
    $ chmod a+x ~/bin/repo
    {% endhighlight %}
    
repo这个工具很小(24KB),但却是下载整个源码不可缺少的工具.

#### 2.修改repo

在国内一定要使用国内的镜像下载，不然连了VPN只有不到100KB/S的下载速度，要下载40g要好几天时间。
下面修改repo文件，把REPO_URL = 'https://gerrit.googlesource.com/git-repo'改成
REPO_URL = 'https://gerrit-googlesource.lug.ustc.edu.cn/git-repo'

#### 3.下载

按照修改完成后,建立一个放置android源码的目录。

    {% highlight c %} 
    $ mkdir androidM
    $ cd androidM
    $ repo init -u https://aosp.tuna.tsinghua.edu.cn/platform/manifest -b android-6.0.1_r17
    $ repo sync
    {% endhighlight %}
    
这时就开始下载源码了，需要的时间比较长。一共40多G,需要多久可以根据自己的下载速度计算。



